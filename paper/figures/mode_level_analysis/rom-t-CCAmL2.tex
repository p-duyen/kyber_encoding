\begin{tikzpicture}[scale=0.65, every node/.style={transform shape}]

    \draw (1,0) \tbcdpa{enc1};
    \node (n) [left of=enc1, node distance = 1.5cm] {$N$};
    \node (k) [below of=enc1, node distance = 1.5cm] {$K$};
    \draw[next] (n) -- node {\bitwidth} node[bitwidth] {$128$} (enc1);            
    \draw[next] (k) -- node {\bitwidth} node[bitwidthvert] {$128$} (enc1); 
    \draw[] (enc1) -- (3,0);            
           
    \begin{scope}[xshift=0cm]
        \draw (3,1.5) \tbcspav{enc2};
        \node (n) [left of=enc2, node distance = 1.2cm] {$N$};
        \draw[next] (n) -- (enc2);            

        \draw (3,-1.5) \tbcspav{enc3};
        \node (n2) [left of=enc3, node distance = 1.2cm] {$N$};
        \draw[next] (n2) -- (enc3);            

        \draw (4.5, -1.5) \xorspav{m0};
        \node (m) [above of=m0, node distance = 1.2cm, color = orange] {$M_0$};
        \node (c) [below of=m0, node distance = 1.2cm] {$C_0$};
        \draw[next] (enc3) -- node {\bitwidth} node[bitwidth] {$128$} (m0);            
        \draw[next] (m) -- (m0);            
        \draw[next] (m0) -- (c);            
        \draw[next] (3, 0) -- (enc2);            
        \draw[next] (3, 0) -- (enc3); 
        \draw[] (enc2) -- (5,1.5);            
        \draw[] (5,1.5) -- (5, 0);            
        \draw[] (5,0) -- (6.5, 0);            
      
    \end{scope}
    \begin{scope}[xshift=3.5cm]
        \draw (3,1.5) \tbcspav{enc2};
        \node (n) [left of=enc2, node distance = 1.2cm] {$N$};
        \draw[next] (n) -- (enc2);            

        \draw (3,-1.5) \tbcspav{enc3};
        \node (n2) [left of=enc3, node distance = 1.2cm] {$N$};
        \draw[next] (n2) -- (enc3); 
        \draw (4.5, -1.5) \xorspav{m0};
        \node (m) [above of=m0, node distance = 1.2cm, color = orange] {$M_1$};
        \node (c) [below of=m0, node distance = 1.2cm] {$C_1$};
        \draw[next] (enc3) -- (m0);            
        \draw[next] (m) -- (m0);            
        \draw[next] (m0) -- (c);            
        \draw[next] (3, 0) -- (enc2);            
        \draw[next] (3, 0) -- (enc3); 
        \draw[dotted] (enc2) -- (5,1.5);            
        \draw[dotted] (5,1.5) -- (5, 0);            
        \draw[dotted] (5,0) -- (7, 0);            
      
    \end{scope}
    \begin{scope}[xshift=7.5cm]
        \draw (3,1.5) \tbcspav{enc2};
        \node (n) [left of=enc2, node distance = 1.2cm] {$N$};
        \draw[next] (n) -- (enc2);            

        \draw (3,-1.5) \tbcspav{enc3};
        \node (n2) [left of=enc3, node distance = 1.2cm] {$N$};
        \draw[next] (n2) -- (enc3); 
        \draw (4.5, -1.5) \xorspav{m0};
        \node (m) [above of=m0, node distance = 1.2cm, color = orange] {$M_m$};
        \node (c) [below of=m0, node distance = 1.2cm] {$C_m$};
        \draw[next] (enc3) -- (m0);            
        \draw[next] (m) -- (m0);            
        \draw[next] (m0) -- (c);            
        \draw[next] (3, 0) -- (enc2);            
        \draw[next] (3, 0) -- (enc3); 
    \end{scope}

    \begin{scope}[xshift=0cm, yshift = -6cm]
        \draw (3,1.5) \tbc{enc2};
        \node (L) [left of=enc2, node distance = 2.5cm] {$\{0\}$};
        \node (C) at (0,0) [] {$C_0$};
        \node (R) at (.5,-1.5) [] {$\{0\}$};
        \draw[] (R) |- (3, 0);            
        \draw[] (C) -- (3, 0);            

        \draw[next] (L) -- (enc2);            

        \draw (3,-1.5) \tbc{enc3};
        \draw (1.75, -1.5) \xor{deltax};
        \node (delta) [left of=deltax, node distance = .5cm] {$\delta$};

        \draw[next] (deltax) -- (enc3);            
        \draw[next] (delta) -- (deltax);   
        \draw[] (1.75,1.5) -- (1.75,.15);                     
        \draw[next] (1.75,-.15) -- (deltax);            

        \draw[] (1,0) -- (3,0);            
        \draw[next] (3,0) -- (enc3);            
        \draw[next] (3,0) -- (enc2);            

        \draw (4.5, 1.5) \xor{deltat};
        \draw[next] (enc2) -- (deltat);            
        \draw[] (1.75,1.5) |- (4.5, 2.5);            
        \draw[next] (4.5,2.5) -- (deltat);            
        \draw[next] (deltat) -- (5.85,1.5);            

        \draw (4.5, -1.5) \xor{deltat2};
        \draw[next] (enc3) -- (deltat2);            
        \draw[] (deltax) |- (4.5, -2.5);            
        \draw[next] (4.5,-2.5) -- (deltat2);            
        \draw[] (deltat2) |- (5,0);            



    \end{scope}

    \begin{scope}[xshift=3.5cm, yshift = -6cm]
        \draw (3,1.5) \tbc{enc2};
        \node (C) at (0.25,0) [] {$C_1$};
        \draw[] (deltat2) |- (3, 0);            
        \draw[] (C) -- (3, 0);            


        \draw (3,-1.5) \tbc{enc3};
        \draw (1.75, -1.5) \xor{deltax};
        \node (delta) [left of=deltax, node distance = .5cm] {$\delta$};

        \draw[next] (deltax) -- (enc3);            
        \draw[next] (delta) -- (deltax);   
        \draw[] (1.75,1.5) -- (1.75,.15);                     
        \draw[next] (1.75,-.15) -- (deltax);            

        \draw[] (1,0) -- (3,0);            
        \draw[next] (3,0) -- (enc3);            
        \draw[next] (3,0) -- (enc2);            

        \draw (4.5, 1.5) \xor{deltat};
        \draw[next, dotted] (enc2) -- (deltat);            
        \draw[] (1.75,1.5) |- (4.5, 2.5);            
        \draw[next] (4.5,2.5) -- (deltat);            
        \draw[next] (deltat) -- (5.85,1.5);            

        \draw (4.5, -1.5) \xor{deltat2};
        \draw[next, dotted] (enc3) -- (deltat2);            
        \draw[] (deltax) |- (4.5, -2.5);            
        \draw[next] (4.5,-2.5) -- (deltat2);            
        \draw[] (deltat2) |- (5,0);            

    \end{scope}
    \begin{scope}[xshift=7cm, yshift = -6cm]
        \draw (3,1.5) \tbc{enc2};

        \draw (3,-1.5) \tbc{enc3};
        \draw (1.75, -1.5) \xor{deltax};
        \node (delta) [left of=deltax, node distance = .5cm] {$\delta$};
        \draw (6,1.5) \tbcdpa{enc4};


        \draw[next] (deltax) -- (enc3);            
        \draw[next] (delta) -- (deltax);   
        \draw[] (1.75,1.5) -- (1.75,.15);                     
        \draw[next] (1.75,-.15) -- (deltax);            

        \draw[] (1,0) -- (3,0);            
        \draw[next] (3,0) -- (enc3);            
        \draw[next] (3,0) -- (enc2);            

        \draw (4.5, 1.5) \xor{deltat};
        \draw[next] (enc2) -- (deltat);            
        \draw[] (1.75,1.5) |- (4.5, 2.5);            
        \draw[next] (4.5,2.5) -- (deltat);            
        \draw[next] (deltat) -- (enc4);            

        \draw (4.5, -1.5) \xor{deltat2};
        \draw[next] (enc3) -- (deltat2);            
        \draw[] (deltax) |- (4.5, -2.5);            
        \draw[next] (4.5,-2.5) -- (deltat2);            
        \draw[next] (deltat2) -| (enc4);         

        \node (tag) [right of=enc4, node distance = 1.5cm] {$T$};
        \draw[next] (enc4) -- (tag);            
        \node (key) [above of=enc4, node distance = 1.2cm] {$K$};
        \draw[next] (key) -- (enc4);            

        \node (C) at (0.25,0) [] {$C_m$};
        \draw[dotted] (C) -- (3, 0);            


    \end{scope}
\end{tikzpicture}