
    \begin{tikzpicture}[scale=0.575, every node/.style={transform shape}]
        \node (key) at (-3, -3) {$K$};
        \draw (-2.7, -3) -- (10.5, -3);
        \draw [-latex] (10,-3) -- (10, -0.6);
        \draw [-latex] (2,-3) -- (2, -0.6);
        \draw [-latex] (6,-3) -- (6, -0.6);
        \draw (12.5, -3) -- (15, -3);
        \draw [-latex] (15,-3) -- (15, -0.6);
        \node at (11.5,-3) {$\cdots\cdots$};

        \node (r0) at (0,0) [minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
        \node (0) [above of=r0, node distance = 1.5cm] {$0^n$};
        \node (00) [left of=r0, node distance = 1.5cm] {$0^n$};
        \draw[next] (0) -- node {\bitwidth} node[bitwidthvert] {$128$} (r0);            
        \draw[next] (00) -- node {\bitwidth} node[bitwidth] {$128$} (r0);            

        \draw (2,0) \tencdpa{enc1};

        %\node (E1) [fill = blue!80, right of=r0, node distance=2cm, minimum size=1.25cm,rounded corners=1ex, draw] { $\tilde{E}_K^{26, 0}$};
        \node (n1) [above of=enc1, node distance = 1.5cm] {$N$};
        \draw[next] (n1) -- node {\bitwidth} node[bitwidthvert] {$128$} (enc1);            
        
        \draw[next] (r0) -- node {\bitwidth} node[bitwidth] {$128$} (enc1);            

        \node (r1) [right of=enc1, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
        \node (M1) [above of=r1, node distance = 1.5cm] {$M[1]$};
        \node (C1) [below of=r1, node distance = 1.5cm] {$C[1]$};

        \draw[-latex] (enc1) -- (r1);
        \draw[next] (M1) -- node {\bitwidth} node[bitwidthvert] {$128$} (r1);            
        \draw[next] (r1) -- node {\bitwidth} node[bitwidthvert] {$128$} (C1);            

        \draw (6,0) \tencdpa{enc2};
        \node (n2) [above of=enc2, node distance = 1.5cm] {$N$};
        \draw[-latex] (n2) -- (enc2);


        \draw[-latex] (r1) -- (enc2);
        \node (r2) [right of=enc2, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
        \node (M2) [above of=r2, node distance = 1.5cm] {$M[2]$};
        \node (C2) [below of=r2, node distance = 1.5cm] {$C[2]$};
        \draw[-latex] (enc2) -- (r2);
        \draw[-latex] (r2) -- (C2);
        \draw[-latex] (M2) -- (r2);

        \draw (10,0) \tencdpa{enc3};
        \draw[-latex] (r2) -- (enc3);
        \node (n3) [above of=enc3, node distance = 1.5cm] {$N$};
        \draw[-latex] (n3) -- (enc3);

        \begin{scope}
            \node at (11.5,0) {$\cdots\cdots$};
        \end{scope}
                    \draw[-latex] (M2) -- (r2);

        \node (r3) at (13,0) [minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
        \node (Mm) [above of=r3, node distance = 1.5cm] {$M[m]$};
        \node (Cm) [below of=r3, node distance = 1.5cm] {$C[m]$};
        \draw[-latex] (r3) -- (Cm);
        \draw[-latex] (Mm) -- (r3);

        \draw (15,0) \tencdpa{E4};
        \node (n4) [above of=E4, node distance = 1.5cm] {$N$};
        \draw[-latex] (n4) -- (E4);
        \node (r4) [right of=E4, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
        \draw[-latex] (r3) -- (E4);
        \draw[-latex] (E4) -- (r4);

        \node (000) [above of=r4, node distance = 1.5cm] {$0^n$};
        \draw[next] (000) -- node {\bitwidth} node[bitwidthvert] {$128$} (r4);            
        \node (T) [below of=r4, node distance = 1.5cm] {$T$};
        \draw[-latex] (r4) -- (T);


    % PARENTHESING
                

    %\node (r) at (2,5cm, 0) [minimum size=1.5cm, minimum height=0.75cm, rounded corners=1ex, draw] {{$\rho$}};
    %\node (0) [above of=r, node distance=2.5cm] {$0^n$};
    %\node (00) [left of=r, node distance = 2.5cm] {$0^n$};
    %\draw[-latex] (0) -- (r);
    %\draw[-latex] (00) -- (r);


    %\node (enc_init) [right of=r, node distance = 2.5cm, minimum size = 2cm, rounded corners=1ex,fill=blue!20,draw] {{\sc $\tilde{E}_K$}};
    %\draw[-latex] (r) -- (enc_init);

\end{tikzpicture}

