
    \begin{tikzpicture}[scale=0.575, every node/.style={transform shape}]


        \node (key) at (-3, -3) {$K$};
        \draw (-2.7, -3) -- (10.5, -3);
        \draw [-latex] (10,-3) -- (10, -0.6);
        \draw [-latex] (2,-3) -- (2, -0.6);
        \draw [-latex] (6,-3) -- (6, -0.6);
        \draw (12.5, -3) -- (15, -3);
        \draw [-latex] (15,-3) -- (15, -0.6);
        \node at (11.5,-3) {$\cdots\cdots$};

            \node (r0) at (0,0) [minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
            \node (00) [left of=r0, node distance = 1.5cm] {$0^n$};
            \draw[next] (00) -- node {\bitwidth} node[bitwidth] {$128$} (r0);            

            \node (E1) at (2,0) [minimum size=1.25cm,rounded corners=1ex, draw] { $\tilde{\mathsf{E}}_K^0$};
            \node (n1) [above of=E1, node distance = 1.5cm] {$N$};
            \draw[next] (n1) -- node {\bitwidth} node[bitwidthvert] {$128$} (E1);            
            \draw[-latex] (r0) -- (E1);
            
            \node (r1) [right of=E1, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
            \node (M1) [above of=r1, node distance = 1.5cm] {$M[1]$};
            \node (C1) [below of=r1, node distance = 1.5cm] {$C[1]$};

            \draw[-latex] (E1) -- (r1);
            \draw[next] (M1) -- node {\bitwidth} node[bitwidthvert] {$128$} (r1);            
            \draw[next] (r1) -- node {\bitwidth} node[bitwidthvert] {$128$} (C1);            

            \node (E2) [right of=r1, node distance = 2cm, minimum size=1.25cm,rounded corners=1ex, draw] {$\tilde{\mathsf{E}}_K^1$};
            \node (n2) [above of=E2, node distance = 1.5cm] {$N$};
            \draw[-latex] (n2) -- (E2);


            \draw[-latex] (r1) -- (E2);
            \node (r2) [right of=E2, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
            \node (M2) [above of=r2, node distance = 1.5cm] {$M[2]$};
            \node (C2) [below of=r2, node distance = 1.5cm] {$C[2]$};
            \draw[-latex] (E2) -- (r2);
            \draw[-latex] (r2) -- (C2);
            \draw[-latex] (M2) -- (r2);

            \node (E3) [right of=r2, node distance = 2cm, minimum size=1.25cm,rounded corners=1ex, draw] {$\tilde{\mathsf{E}}_K^2$};
            \draw[-latex] (r2) -- (E3);
            \node (n3) [above of=E3, node distance = 1.5cm] {$N$};
            \draw[-latex] (n3) -- (E3);

            \begin{scope}
                \node at (11.5,0) {$\cdots\cdots$};
            \end{scope}
                        \draw[-latex] (M2) -- (r2);

                        \node (r3) at (13,0) [minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
                        \node (Mm) [above of=r3, node distance = 1.5cm] {M[m]};
                        \node (Cm) [below of=r3, node distance = 1.5cm] {$C[m]$};
                        \draw[-latex] (r3) -- (Cm);
                        \draw[-latex] (Mm) -- (r3);

            \node (E4) [right of=r3, node distance = 2cm, minimum size=1.25cm,rounded corners=1ex, draw] {$\tilde{\mathsf{E}}_K^m$};
            \node (n4) [above of=E4, node distance = 1.5cm] {$N$};
            \draw[-latex] (n4) -- (E4);
            \node (r4) [right of=E4, node distance=2cm, minimum size=1.25cm, minimum height = 0.75cm, rounded corners=1ex, draw] {$\rho$};
            \draw[-latex] (r3) -- (E4);
            \draw[-latex] (E4) -- (r4);

            \node (000) [above of=r4, node distance = 1.5cm] {$0^n$};
            \draw[next] (000) -- node {\bitwidth} node[bitwidthvert] {$128$} (r4);            
            \node (T) [below of=r4, node distance = 1.5cm] {$T$};
            \draw[-latex] (r4) -- (T);

		% PARENTHESING
					
	
        %\node (r) at (2,5cm, 0) [minimum size=1.5cm, minimum height=0.75cm, rounded corners=1ex, draw] {{$\rho$}};
        %\node (0) [above of=r, node distance=2.5cm] {$0^n$};
        %\node (00) [left of=r, node distance = 2.5cm] {$0^n$};
        %\draw[-latex] (0) -- (r);
        %\draw[-latex] (00) -- (r);


        %\node (enc_init) [right of=r, node distance = 2.5cm, minimum size = 2cm, rounded corners=1ex,fill=blue!20,draw] {{\sc $\tilde{E}_K$}};
        %\draw[-latex] (r) -- (enc_init);

    \end{tikzpicture}

