


%% Document
\begin{tikzpicture}[
]
\node [] (i) at (-1, -.42) {$\mathsf{in}$};
\node [] (o) at (12, .42) {$\mathsf{out}$};
\node [] (zero) at (9, .84) {$\mathsf{\{0\}}$};
\node [] (tk) at (2, -1.58) {$\mathsf{tweakey}$};

\node [mux 2by2, rotate = 0](M1) at (0, 0){};
\node [mux 2by2, rotate = 0](M2) at (10, 0.42){};
\node [mux 2by2, rotate = 0](M3) at (3.25, -2){};

\node[rectangle,
minimum width = 1.2cm,
minimum height = 1.2cm,
draw] (B1) at (1.5,0) {\textsf{SBOX}};

\node[rectangle,
minimum width = 1.2cm,
minimum height = 1.2cm,
rounded corners = 5pt,
draw] (arc) at (3,0) {\textsf{ARC}};


\node[rectangle,
minimum width = 1.2cm,
rounded corners = 5pt, 
minimum height = 1.2cm,
draw] (art) at (4.5,0) {\textsf{ART}};
\node [] (ll) at (5, .9) {\footnotesize\textsf{Linear Layer}};

\node[rectangle,
dashed,
minimum width = 6cm,
minimum height = 1.5cm,
draw] (sr) at (5.25,0) {};

\node[rectangle,
minimum width = 1.2cm,
rounded corners = 5pt, 
minimum height = 1.2cm,
draw] (sr) at (6,0) {\textsf{SR}};

\node[rectangle,
minimum width = 1.2cm,
rounded corners = 5pt, 
minimum height = 1.2cm,
draw] (mc) at (7.5,0) {\textsf{MC}};

\node[rectangle,
minimum width = 1.2cm,
rounded corners = 5pt, 
minimum height = 1.2cm,
draw] (P) at (6, -2) {\textsf{P}};

\node[rectangle,
minimum width = 1.2cm,
rounded corners = 5pt, 
minimum height = 1.2cm,
draw] (LFSR) at (7.5,-2) { \textsf{LFSR}};

\draw [] (9, -2) \registerEn{reg1};
\draw [] (11, .42) \register{rego};



\draw [-latex] (B1) -- (arc);
\draw [-latex] (arc) -- (art);
\draw [-latex] (art) -- (sr);
\draw [-latex] (sr) -- (mc);
\draw [-latex] (B1) -- (arc);
\draw [-latex] (mc) -- (M2.blpin 2);
\draw [-latex] (M1.brpin 1) -- (B1);
\draw [] (8.5, 0) |- (-1,1.5);
\draw [-latex] (i) -- (M1.blpin 2);

\draw [-latex] (-1, 1.5) |- (M1.blpin 1);
\draw [-latex] (M2.brpin 1) -- (rego);
\draw [-latex] (rego) -- (o);

\draw [-latex] (M3.brpin 1) -- (P);
\draw [-latex] (P) -- (LFSR);
\draw [-latex] (4.5,-2) -- (art);
\draw [-latex] (LFSR) -- (reg1);

\draw [] (reg1) -- (10, -2);

\draw [] (10, -2) |- (2.5, -3.5);
\draw [-latex] (2.5, -3.5) |- (M3.blpin 2);
\draw [-latex] (tk) -- (M3.blpin 1);

\node[rectangle,
dashed,
minimum width = 6.75cm,
minimum height = 1.9cm,
draw] (sr) at (6.12,-2) {};
\node [] (ll) at (6.12, -3.2) {\footnotesize\textsf{Tweakey Scheduling}};
\draw [-latex] (zero) -- (M2.blpin 1);

\end{tikzpicture}