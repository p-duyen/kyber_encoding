\begin{tikzpicture}[thick]% coordinates%\begin{}[]%\addplot coordinates {};%\end{}%\end{}
    \node [mux 2by2, anchor=lpin 1, rotate = 180] (mux2) at (0, -.08){};
    \node [mux 2by2, anchor=lpin 1, rotate = 180] (mux2) at (3.5, -.5){};

    \node [name=dpa,rectangle, rounded corners=3pt, minimum width=1.2cm, minimum height=1.2cm, draw, sparsam, thick] at (1, -0.075) { $\pi_{DPA}$};
    \node [name=spa1,rectangle, rounded corners=3pt, minimum width=1.2cm, minimum height=1.2cm, draw, sparsam, thick] at (5, .5) { $\pi_{SPA}$};
    \node [name=spa2,rectangle, rounded corners=3pt, minimum width=1.2cm, minimum height=1.2cm, draw, sparsam, thick] at (5, -1.5) { $\pi_{SPA}$};
    \node [name=h,rectangle, rounded corners=3pt, minimum width=1.2cm, minimum height=1.2cm, draw, sparsam, thick] at (8, .5) { $H$};

    \draw (6.5,.5) \xord{xor1};
    \draw[-latex] (spa1) -- (xor1);
    \draw (3.5,-.5) -- (3.75,-.5);
    \draw(3.75,-.5) -- (3.75, 0.5);
    \draw(3.75, .5) -- (3.75,-1.5);
    \draw[-latex] (3.75, 0.5) -- (spa1);
    \draw[-latex] (3.75, -1.5) -- (spa2);
    \draw (spa2) -- (6.5, -1.5);
    \draw (6.5, -1.5) -- (6.5, -3);
    \draw (6.5, -3) -- (2, -3);
    \draw (2, -3) -- (2, -.92);
    \draw (2, -.92) -- (2.2, -.92);
    \draw (dpa) -- (2.2, -0.075);
    \draw[-latex] (-.2, -0.075) -- (.4, -0.075);
    \node [] (m) at (6.5, 1.5) {$M$};
    \draw[-latex] (m) -- (xor1);
    \draw[-latex] (xor1) -- (h);
    \draw (h) -- (9.5,.5);
    \draw (9.5, .5) -- (9.5, 2);
    \draw(9.5, 2) -- (-2, 2);
    \draw (-2, 2) -- (-2, 0.34);
    \draw[-latex] (-2, 0.34) -- (-1.1, .34);
\end{tikzpicture}